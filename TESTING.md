# Инструкция по тестированию проекта

Это руководство поможет проверить основной функционал веб-приложения для бронирования комнат.

## 1. Тестирование регистрации и входа

1. **Регистрация нового пользователя:**
    * Перейдите на `/register`.
    * Введите имя пользователя (например, `testuser`) и пароль (`password123`).
    * Нажмите "Зарегистрироваться".
    * **Ожидаемый результат:** Вас должно перенаправить на страницу входа с сообщением об успешной регистрации.

2. **Попытка регистрации с существующим именем:**
    * Снова перейдите на `/register`.
    * Введите то же имя пользователя (`testuser`).
    * **Ожидаемый результат:** Должно появиться сообщение об ошибке "Это имя пользователя уже занято".

3. **Вход пользователя:**
    * Перейдите на `/login`.
    * Введите данные созданного пользователя (`testuser`, `password123`).
    * **Ожидаемый результат:** Успешный вход и перенаправление на главную страницу. В навигации должно появиться приветствие "Привет, testuser!".

4. **Вход администратора:**
    * Выйдите из системы.
    * Перейдите на `/login`.
    * Введите данные администратора по умолчанию (`admin`, `admin`).
    * **Ожидаемый результат:** Успешный вход. В навигации должна появиться ссылка "Панель администратора".

## 2. Тестирование ролей и доступов

1. **Доступ к панели администратора:**
    * Войдите как обычный пользователь (`testuser`).
    * Попробуйте перейти по прямому URL `/admin`.
    * **Ожидаемый результат:** Доступ должен быть запрещен, появится flash-сообщение об ошибке и произойдет перенаправление на главную страницу.

2. **Проверка прав администратора:**
    * Войдите как `admin`.
    * Перейдите в "Панель администратора".
    * **Ожидаемый результат:** Страница `/admin` успешно открывается.

## 3. Тестирование CRUD-операций (Администратор)

Выполнять под пользователем `admin`.

1. **Создание (Create):**
    * На панели администратора в форме "Добавить новую комнату" введите название (например, "Комната для совещаний") и описание.
    * Нажмите "Добавить".
    * **Ожидаемый результат:** Новая комната появляется в списке комнат на этой же странице и на главной.

2. **Чтение (Read):**
    * Убедитесь, что все созданные комнаты отображаются в списке на `/admin` и на `/`.

3. **Обновление (Update):**
    * В списке комнат измените название или описание у существующей комнаты.
    * Нажмите "Сохранить".
    * **Ожидаемый результат:** Данные комнаты обновятся в списке.

4. **Удаление (Delete):**
    * Нажмите кнопку "Удалить" рядом с одной из комнат.
    * **Ожидаемый результат:** Комната исчезнет из списка.

## 4. Тестирование функционала бронирования

1. **Бронирование комнаты (пользователь):**
    * Войдите как `testuser`.
    * На главной странице нажмите "Забронировать" у любой комнаты.
    * Выберите дату и время, нажмите "Подтвердить".
    * **Ожидаемый результат:** Появится сообщение об успешном бронировании. Новая бронь появится в общем расписании на главной странице.

2. **Просмотр своих бронирований:**
    * Перейдите в "Мои бронирования".
    * **Ожидаемый результат:** Отображается список только тех комнат, которые забронировал `testuser`.

3. **Отмена своей брони:**
    * В "Моих бронированиях" нажмите "Отменить" рядом с бронью.
    * **Ожидаемый результат:** Бронь исчезает из списка.

4. **Отмена чужой брони (администратор):**
    * Пусть `testuser` сделает бронь.
    * Войдите как `admin` и перейдите в "Панель администратора".
    * В списке "Все бронирования" найдите бронь пользователя `testuser` и нажмите "Отменить".
    * **Ожидаемый результат:** Бронь успешно отменена.

## 5. Тестирование безопасности

1. **Защита от XSS (Cross-Site Scripting):**
    * Войдите как `admin`.
    * При создании или редактировании комнаты введите в название или описание вредоносный скрипт, например: `<script>alert('XSS')</script>`.
    * **Ожидаемый результат:** На странице текст должен отобразиться как обычная строка `<script>alert('XSS')</script>`, а не как исполняемый скрипт (всплывающее окно не должно появиться). Это показывает, что Jinja2 корректно экранирует вывод.

2. **Защита от SQL-инъекций:**
    * *Это сложнее проверить вручную, но код использует параметризированные запросы (`?` в SQL-запросах), что является стандартной и надежной защитой. Например, `db.execute('SELECT * FROM users WHERE username = ?', (username,))` безопасен, так как драйвер базы данных обрабатывает переменную `username` как данные, а не как часть SQL-команды.*
